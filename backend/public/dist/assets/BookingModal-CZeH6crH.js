import{r as x,j as t}from"./index-DS6xzyDc.js";import{A as F}from"./index-CtH1GgoR.js";import{m as B}from"./proxy-UvVlwBeo.js";const O=({section:w,currentTime:u,onClose:m,onConfirm:T,deskId:s,deskStatus:i="available",isLiveMode:D=!0,deskLocation:g="N/A",deskName:f="N/A",isOccupied:M=!1})=>{const[o,W]=x.useState(typeof window<"u"&&window.innerWidth<768),[l,y]=x.useState([]),[C,k]=x.useState(!0),[b,E]=x.useState({section:w,deskId:s,date:new Date().toISOString().split("T")[0],startTime:"09:00",endTime:"17:00"});x.useEffect(()=>{if(typeof window>"u")return;const e=()=>W(window.innerWidth<768);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),x.useEffect(()=>{if(!s)return;(async()=>{try{k(!0);const r=localStorage.getItem("token"),a=await fetch("https://molsongbsspaces.onrender.com/api/desk/all",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});if(!a.ok)throw new Error("Failed to fetch desk bookings");const c=await a.json(),h=(c.data||c||[]).find(n=>{if(n.name===s||n.id===s||n._id===s||n.locationId===s||n.locationId===g||n.locationId===f)return!0;if(n.locationId){const p=s.match(/Table (\d+) (UP|DOWN)/);if(p){const S=p[1];if(n.locationId.toLowerCase().includes(`table${S}`.toLowerCase()))return!0}}return!1});if(console.log("ðŸ“Š Found desk for bookings:",h),console.log("ðŸ” Search parameters:",{deskId:s,deskLocation:g,deskName:f}),h&&h.bookings){const n=h.bookings.filter(p=>p.status!=="declined").sort((p,S)=>new Date(S.start)-new Date(p.start));console.log("ðŸ“… Found bookings:",n),y(n)}else console.log("âš ï¸ No desk found or no bookings available"),y([])}catch(r){console.error("Error fetching desk bookings:",r),y([])}finally{k(!1)}})()},[s,g,f]);const A=e=>{e.preventDefault(),T(b)},v=(e,r)=>{E(a=>({...a,[e]:r}))},j=[];for(let e=0;e<24;e++)for(let r=0;r<60;r+=30){const a=`${e.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`;j.push(a)}const z=u instanceof Date&&!Number.isNaN(u.getTime())?u:new Date,R=z.toLocaleTimeString([],{hour12:!1}),L=z.toLocaleString([],{hour12:!1,year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return t.jsx(F,{children:t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:o?"16px":"20px"},onClick:m,children:t.jsxs(B.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{duration:.3},onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"16px",padding:o?"20px 16px":"30px",maxWidth:"500px",width:"100%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",maxHeight:o?"95vh":"90vh",overflow:"auto",boxSizing:"border-box"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:o?"16px":"20px",paddingBottom:o?"12px":"15px",borderBottom:"2px solid #f0f0f0"},children:[t.jsxs("h2",{style:{fontSize:o?"20px":"24px",fontWeight:"bold",color:"#0067AC",margin:0},children:["Book: ",w]}),t.jsx("button",{onClick:m,style:{background:"transparent",border:"none",fontSize:"28px",cursor:"pointer",color:"#999",padding:"0",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"all 0.2s"},onMouseEnter:e=>{e.target.style.background="#f0f0f0",e.target.style.color="#333"},onMouseLeave:e=>{e.target.style.background="transparent",e.target.style.color="#999"},children:"Ã—"})]}),t.jsx("div",{style:{padding:o?"12px 14px":"16px 18px",borderRadius:"12px",marginBottom:"16px",background:"linear-gradient(135deg, #f0f9ff, #e0f2fe)",border:"1px solid rgba(2, 132, 199, 0.2)",boxShadow:"0 4px 12px rgba(2, 132, 199, 0.08)"},children:t.jsxs("div",{style:{display:"grid",gridTemplateColumns:o?"1fr":"1fr 1fr",gap:o?"10px":"16px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:o?"11px":"12px",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"600",color:"#0284c7",marginBottom:"4px"},children:"ðŸ“ Location"}),t.jsx("div",{style:{fontSize:o?"13px":"15px",fontWeight:"600",color:"#0f172a"},children:g})]}),t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:o?"11px":"12px",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"600",color:"#0284c7",marginBottom:"4px"},children:"ðŸ·ï¸ Desk Reference"}),t.jsx("div",{style:{fontSize:o?"13px":"15px",fontWeight:"600",color:"#0f172a",fontFamily:"monospace"},children:f})]})]})}),t.jsxs("div",{style:{padding:o?"12px 14px":"14px 16px",borderRadius:"12px",marginBottom:"16px",background:"linear-gradient(135deg, #fef3c7, #fde68a)",border:"1px solid rgba(245, 158, 11, 0.3)",boxShadow:"0 4px 12px rgba(245, 158, 11, 0.1)"},children:[t.jsxs("div",{style:{fontSize:o?"12px":"13px",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"700",color:"#92400e",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:["ðŸ“… Booking Schedule ",!C&&`(${l.length})`]}),C?t.jsx("div",{style:{fontSize:o?"12px":"13px",color:"#78716c",textAlign:"center",padding:"8px 0"},children:"Loading bookings..."}):l.length===0?t.jsx("div",{style:{padding:o?"12px 10px":"14px 12px",background:"rgba(255, 255, 255, 0.7)",borderRadius:"8px",border:"1px solid rgba(120, 113, 108, 0.2)",textAlign:"center",fontSize:o?"12px":"13px",color:"#78716c"},children:"âœ¨ No bookings yet - This desk is completely free!"}):t.jsxs("div",{style:{maxHeight:"150px",overflowY:"auto",display:"flex",flexDirection:"column",gap:"8px"},children:[l.slice(0,5).map((e,r)=>{const a=new Date(e.start),c=new Date(e.end),d=new Date>=a&&new Date<=c;return t.jsxs("div",{style:{padding:o?"8px 10px":"10px 12px",background:d?"rgba(239, 68, 68, 0.1)":"rgba(255, 255, 255, 0.7)",borderRadius:"8px",border:d?"1px solid rgba(239, 68, 68, 0.3)":"1px solid rgba(120, 113, 108, 0.2)",fontSize:o?"11px":"12px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[t.jsxs("span",{style:{fontWeight:"700",color:d?"#991b1b":"#0f172a",display:"flex",alignItems:"center",gap:"4px"},children:[d&&"ðŸ”´ ",e.status==="accepted"?"âœ…":e.status==="pending"?"â³":"âŒ",e.status.toUpperCase()]}),e.requester?.name&&t.jsx("span",{style:{fontSize:o?"10px":"11px",color:"#64748b",fontWeight:"500"},children:e.requester.name})]}),t.jsxs("div",{style:{color:"#57534e",fontWeight:"500"},children:["ðŸ“† ",a.toLocaleDateString([],{month:"short",day:"numeric",year:"numeric"})]}),t.jsxs("div",{style:{color:"#78716c",marginTop:"2px"},children:["â° ",a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," - ",c.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),d&&t.jsx("div",{style:{marginTop:"4px",fontSize:o?"10px":"11px",color:"#991b1b",fontWeight:"600"},children:"ðŸ”´ Currently Active"})]},e._id||r)}),l.length>5&&t.jsxs("div",{style:{padding:o?"6px 8px":"8px 10px",background:"rgba(146, 64, 14, 0.1)",borderRadius:"6px",textAlign:"center",fontSize:o?"10px":"11px",color:"#92400e",fontWeight:"600"},children:["+ ",l.length-5," more booking",l.length-5>1?"s":""]})]})]}),t.jsx("div",{style:{padding:"15px",borderRadius:"8px",marginBottom:"20px",background:i==="available"?"#E8F5E9":i==="pending"?"#FEF3C7":"#FFEBEE",border:`1px solid ${i==="available"?"#4CAF50":i==="pending"?"#fbbf24":"#ef4444"}`},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",fontSize:"14px",fontWeight:"bold",color:i==="available"?"#2E7D32":i==="pending"?"#92400e":"#C62828"},children:[t.jsx("span",{style:{fontSize:"20px"},children:i==="available"?"âœ“":i==="pending"?"â³":"âœ—"}),t.jsx("span",{children:i==="available"?D?`Available now (${R})`:`Available on ${L}`:i==="pending"?"Pending approval - Select a different time or wait for approval":"Currently booked - Select a different time"})]})}),t.jsxs("form",{onSubmit:A,children:[t.jsxs("div",{style:{marginBottom:"20px"},children:[t.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#333",fontSize:"14px"},children:"ðŸ“… Date"}),t.jsx("input",{type:"date",value:b.date,onChange:e=>v("date",e.target.value),min:new Date().toISOString().split("T")[0],required:!0,style:{width:"100%",padding:"12px",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"14px",transition:"border-color 0.2s",boxSizing:"border-box"},onFocus:e=>e.target.style.borderColor="#0067AC",onBlur:e=>e.target.style.borderColor="#e0e0e0"})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:o?"1fr":"1fr 1fr",gap:o?"12px":"15px",marginBottom:"20px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#333",fontSize:"14px"},children:"â° Start Time"}),t.jsx("select",{value:b.startTime,onChange:e=>v("startTime",e.target.value),required:!0,style:{width:"100%",padding:"12px",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"14px",transition:"border-color 0.2s",boxSizing:"border-box",cursor:"pointer"},onFocus:e=>e.target.style.borderColor="#0067AC",onBlur:e=>e.target.style.borderColor="#e0e0e0",children:j.map(e=>t.jsx("option",{value:e,children:e},e))})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#333",fontSize:"14px"},children:"â° End Time"}),t.jsx("select",{value:b.endTime,onChange:e=>v("endTime",e.target.value),required:!0,style:{width:"100%",padding:"12px",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"14px",transition:"border-color 0.2s",boxSizing:"border-box",cursor:"pointer"},onFocus:e=>e.target.style.borderColor="#0067AC",onBlur:e=>e.target.style.borderColor="#e0e0e0",children:j.map(e=>t.jsx("option",{value:e,children:e},e))})]})]}),t.jsxs("div",{style:{display:"flex",gap:o?"8px":"10px",justifyContent:o?"stretch":"flex-end",flexDirection:o?"column":"row"},children:[t.jsx("button",{type:"button",onClick:m,style:{padding:o?"10px 16px":"12px 24px",border:"2px solid #e0e0e0",borderRadius:"8px",background:"white",color:"#666",fontSize:o?"13px":"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s",flex:o?"1":"auto"},onMouseEnter:e=>{e.target.style.background="#f5f5f5",e.target.style.borderColor="#999"},onMouseLeave:e=>{e.target.style.background="white",e.target.style.borderColor="#e0e0e0"},children:"Cancel"}),t.jsx(B.button,{type:"submit",whileHover:{scale:1.02},whileTap:{scale:.98},style:{padding:o?"10px 16px":"12px 32px",border:"none",borderRadius:"8px",background:"linear-gradient(135deg, #0067AC 0%, #002147 100%)",color:"white",fontSize:o?"13px":"14px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 12px rgba(0, 103, 172, 0.3)",transition:"box-shadow 0.2s",flex:o?"1":"auto"},onMouseEnter:e=>{e.target.style.boxShadow="0 6px 20px rgba(0, 103, 172, 0.4)"},onMouseLeave:e=>{e.target.style.boxShadow="0 4px 12px rgba(0, 103, 172, 0.3)"},children:"Confirm Booking"})]})]}),t.jsxs("div",{style:{marginTop:"20px",padding:"12px",background:"#f8f9fa",borderRadius:"8px",fontSize:"12px",color:"#666"},children:[t.jsxs("p",{style:{margin:"0 0 5px 0"},children:["ðŸ’¡ ",t.jsx("strong",{children:"Tip:"})," You can book up to 30 days in advance."]}),t.jsx("p",{style:{margin:0},children:"ðŸ“§ You'll receive a confirmation email once your booking is confirmed."})]})]})})})};export{O as default};
