import{r as n,j as r}from"./index-DS6xzyDc.js";import{m as l}from"./proxy-UvVlwBeo.js";function P(){const[e,z]=n.useState(!1),[i,m]=n.useState({name:"",username:"",email:"",password:"",confirmPassword:"",role:"user"}),[g,b]=n.useState(!1),[u,s]=n.useState(""),[w,y]=n.useState(""),[h,S]=n.useState([]),[x,j]=n.useState(!1),[v,k]=n.useState("");n.useEffect(()=>{const t=()=>z(window.innerWidth<768);return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const p=t=>{const{name:a,value:o}=t.target;m(d=>({...d,[a]:o}))},W=()=>!i.name.trim()||!i.email.trim()||!i.password.trim()?(s("Please fill name, email, and password."),!1):i.confirmPassword&&i.confirmPassword!==i.password?(s("Password confirmation does not match."),!1):/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.email.trim())?(s(""),!0):(s("Please enter a valid email address."),!1),A=t=>{if(t==null)return"N/A";const a=typeof t=="string"?t:String(t);return a.length<=10?a:`${a.slice(0,4)}...${a.slice(-4)}`},C=t=>{if(!t)return"N/A";const a=new Date(t);return Number.isNaN(a.getTime())?"N/A":a.toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},f=async()=>{try{j(!0),k("");const t=localStorage.getItem("token");if(!t)throw new Error("Missing authentication token");const a=await fetch("https://molsongbsspaces.onrender.com/api/user/all",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(!a.ok){const T=await a.json().catch(()=>({}));throw new Error(T.message||"Failed to fetch users")}const o=await a.json(),d=Array.isArray(o?.data)?o.data:Array.isArray(o)?o:[];S(d)}catch(t){console.error("Error fetching users:",t),S([]),k(t.message||"Unable to load users")}finally{j(!1)}};n.useEffect(()=>{f().catch(()=>{})},[]);const R=async t=>{if(t.preventDefault(),!!W()){b(!0),s(""),y("");try{const a=localStorage.getItem("token"),o=await fetch("https://molsongbsspaces.onrender.com/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json",...a?{Authorization:`Bearer ${a}`}:{}},body:JSON.stringify({name:i.name.trim(),username:i.username.trim(),email:i.email.trim(),password:i.password,role:i.role})});if(!o.ok){const d=await o.json().catch(()=>({}));throw new Error(d.message||"Registration failed")}y("User successfully registered."),m({name:"",username:"",email:"",password:"",confirmPassword:"",role:"user"}),await f()}catch(a){console.error("Registration error:",a),s(a.message||"Registration error")}finally{b(!1)}}},c=n.useMemo(()=>Array.isArray(h)?h.map(t=>({id:t._id||t.id,name:t.name||t.fullName||"N/A",username:t.username||"N/A",email:t.email||"N/A",role:t.role||"user",createdAt:t.createdAt||t.created_at,status:t.status||"active"})).sort((t,a)=>{const o=t.createdAt?new Date(t.createdAt).getTime():0;return(a.createdAt?new Date(a.createdAt).getTime():0)-o}):[],[h]);return r.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #e0e7ff 45%, #dbeafe 100%)",padding:e?"24px 12px":"48px 24px",overflow:"hidden",width:"100%"},children:r.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",position:"relative",width:"100%",boxSizing:"border-box"},children:[r.jsx(l.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},style:{marginBottom:e?"20px":"32px"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:e?"12px":"18px",flexWrap:"wrap"},children:[r.jsx(l.div,{animate:{rotate:[0,4,-4,0],scale:[1,1.04,1]},transition:{duration:2.4,repeat:1/0,repeatDelay:3},style:{background:"linear-gradient(135deg, #0067AC, #1d4ed8)",borderRadius:"14px",padding:"14px",boxShadow:"0 10px 25px rgba(30, 64, 175, 0.25)",flexShrink:0},children:r.jsxs("svg",{width:e?"24":"30",height:e?"24":"30",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("path",{d:"M12 12C14.7614 12 17 9.76142 17 7C17 4.23858 14.7614 2 12 2C9.23858 2 7 4.23858 7 7C7 9.76142 9.23858 12 12 12Z",stroke:"#bfdbfe",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M4 22C4 17.5817 7.58172 14 12 14C16.4183 14 20 17.5817 20 22",stroke:"#bfdbfe",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}),r.jsxs("div",{children:[r.jsx("h1",{style:{fontSize:e?"24px":"34px",fontWeight:"800",background:"linear-gradient(135deg, #0f172a, #1d4ed8)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",letterSpacing:"-0.4px",margin:0},children:"Register Users"}),r.jsx("p",{style:{color:"#475569",margin:"6px 0 0 0",fontSize:e?"13px":"16px",fontWeight:"500"},children:"Invite teammates and review who already has access to the workspace"})]})]})}),r.jsxs("div",{style:{display:"grid",gap:e?"18px":"28px",width:"100%",boxSizing:"border-box"},children:[r.jsxs(l.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.45},style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(241, 245, 249, 0.95))",border:"1px solid rgba(148, 163, 184, 0.25)",borderRadius:"18px",padding:e?"20px 16px":"26px 28px 30px",width:"100%",boxSizing:"border-box",boxShadow:"0 18px 40px rgba(15, 23, 42, 0.12)"},children:[r.jsx("h2",{style:{fontSize:e?"18px":"20px",color:"#0f172a",margin:"0 0 16px 0",fontWeight:"700"},children:"Invite a new user"}),u&&r.jsx("div",{style:{marginBottom:"12px",color:"#991b1b",background:"rgba(248, 113, 113, 0.15)",padding:"10px 12px",borderRadius:"10px",border:"1px solid rgba(248, 113, 113, 0.25)"},children:u}),w&&r.jsx("div",{style:{marginBottom:"12px",color:"#166534",background:"rgba(34, 197, 94, 0.15)",padding:"10px 12px",borderRadius:"10px",border:"1px solid rgba(34, 197, 94, 0.25)"},children:w}),r.jsxs("form",{onSubmit:R,style:{display:"grid",gap:e?"12px":"16px"},children:[r.jsxs("div",{style:{display:"grid",gap:e?"12px":"14px",gridTemplateColumns:e?"1fr":"repeat(auto-fit, minmax(220px, 1fr))"},children:[r.jsx("input",{name:"name",placeholder:"Full name",value:i.name,onChange:p,style:{padding:e?"11px 12px":"12px 14px",borderRadius:"12px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(255, 255, 255, 0.75)",color:"#0f172a",fontWeight:"500",fontSize:e?"14px":"16px"}}),r.jsx("input",{name:"username",placeholder:"Username",value:i.username,onChange:p,style:{padding:e?"11px 12px":"12px 14px",borderRadius:"12px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(255, 255, 255, 0.75)",color:"#0f172a",fontWeight:"500",fontSize:e?"14px":"16px"}}),r.jsx("input",{name:"email",placeholder:"Email",type:"email",value:i.email,onChange:p,style:{padding:e?"11px 12px":"12px 14px",borderRadius:"12px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(255, 255, 255, 0.75)",color:"#0f172a",fontWeight:"500",fontSize:e?"14px":"16px"}}),r.jsx("input",{name:"password",placeholder:"Password",type:"password",value:i.password,onChange:p,style:{padding:e?"11px 12px":"12px 14px",borderRadius:"12px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(255, 255, 255, 0.75)",color:"#0f172a",fontWeight:"500",fontSize:e?"14px":"16px"}}),r.jsx("input",{name:"confirmPassword",placeholder:"Confirm password",type:"password",value:i.confirmPassword,onChange:p,style:{padding:e?"11px 12px":"12px 14px",borderRadius:"12px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(255, 255, 255, 0.75)",color:"#0f172a",fontWeight:"500",fontSize:e?"14px":"16px"}}),r.jsxs("select",{name:"role",value:i.role,onChange:p,style:{padding:e?"11px 12px":"12px 14px",borderRadius:"12px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(255, 255, 255, 0.75)",color:"#0f172a",fontWeight:"500",fontSize:e?"14px":"16px",cursor:"pointer"},children:[r.jsx("option",{value:"user",children:"User"}),r.jsx("option",{value:"manager",children:"Manager"}),r.jsx("option",{value:"admin",children:"Admin"})]})]}),r.jsx(l.button,{type:"submit",whileHover:{y:-2,boxShadow:"0 18px 38px rgba(30, 64, 175, 0.25)"},whileTap:{scale:.98},disabled:g,style:{justifySelf:"flex-start",padding:"12px 24px",background:"linear-gradient(135deg, #1d4ed8, #3b82f6)",color:"#f8fafc",border:"none",borderRadius:"12px",fontWeight:"700",cursor:g?"not-allowed":"pointer",letterSpacing:"0.5px",opacity:g?.7:1,transition:"opacity 0.2s ease"},children:g?"Creating...":"Create account"})]})]}),r.jsxs(l.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.45,delay:.1},style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.94), rgba(241, 245, 249, 0.98))",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"18px",padding:e?"18px 16px":"24px",width:"100%",boxSizing:"border-box",boxShadow:"0 20px 42px rgba(15, 23, 42, 0.12)",overflow:"hidden"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"12px",marginBottom:"18px",flexDirection:e?"column":"row"},children:[r.jsxs("div",{children:[r.jsx("h2",{style:{fontSize:e?"18px":"20px",color:"#0f172a",margin:"0 0 4px 0",fontWeight:"700"},children:"Existing users"}),r.jsxs("p",{style:{color:"#64748b",margin:0,fontSize:"14px"},children:[c.length," user",c.length===1?"":"s"," found"]})]}),r.jsx(l.button,{onClick:()=>f(),whileHover:{scale:1.02},whileTap:{scale:.98},disabled:x,style:{padding:e?"10px 16px":"8px 16px",borderRadius:"999px",border:"1px solid rgba(37, 99, 235, 0.25)",background:"linear-gradient(135deg, #eff6ff, #dbeafe)",color:"#1d4ed8",fontWeight:"600",cursor:x?"not-allowed":"pointer",boxShadow:"0 10px 20px rgba(59, 130, 246, 0.1)",opacity:x?.7:1,fontSize:e?"13px":"14px",width:e?"100%":"auto"},children:x?"Refreshing...":"Refresh list"})]}),v&&r.jsx("div",{style:{marginBottom:"14px",color:"#991b1b",background:"rgba(248, 113, 113, 0.12)",padding:"12px 14px",borderRadius:"12px",border:"1px solid rgba(248, 113, 113, 0.22)"},children:v}),r.jsx("div",{style:{overflowX:"auto",borderRadius:"14px",border:"1px solid rgba(148, 163, 184, 0.2)",background:"rgba(248, 250, 252, 0.85)",WebkitOverflowScrolling:"touch",width:"100%",maxWidth:"100%"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:e?"520px":"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{background:"linear-gradient(135deg, rgba(226, 232, 240, 0.9), rgba(203, 213, 225, 0.7))",color:"#0f172a",textAlign:"left"},children:[r.jsx("th",{style:{padding:e?"10px 8px":"14px 16px",fontSize:e?"10px":"12px",textTransform:"uppercase",letterSpacing:"0.4px",fontWeight:"700",whiteSpace:"nowrap"},children:"Name"}),r.jsx("th",{style:{padding:e?"10px 8px":"14px 16px",fontSize:e?"10px":"12px",textTransform:"uppercase",letterSpacing:"0.4px",fontWeight:"700",whiteSpace:"nowrap"},children:"Username"}),r.jsx("th",{style:{padding:e?"10px 8px":"14px 16px",fontSize:e?"10px":"12px",textTransform:"uppercase",letterSpacing:"0.4px",fontWeight:"700",whiteSpace:"nowrap"},children:"Email"}),r.jsx("th",{style:{padding:e?"10px 8px":"14px 16px",fontSize:e?"10px":"12px",textTransform:"uppercase",letterSpacing:"0.4px",fontWeight:"700",whiteSpace:"nowrap"},children:"Role"}),r.jsx("th",{style:{padding:e?"10px 8px":"14px 16px",fontSize:e?"10px":"12px",textTransform:"uppercase",letterSpacing:"0.4px",fontWeight:"700",whiteSpace:"nowrap"},children:"Created"}),r.jsx("th",{style:{padding:e?"10px 8px":"14px 16px",fontSize:e?"10px":"12px",textTransform:"uppercase",letterSpacing:"0.4px",fontWeight:"700",whiteSpace:"nowrap"},children:"ID"})]})}),r.jsx("tbody",{children:x&&c.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:6,style:{padding:e?"12px":"20px",textAlign:"center",color:"#64748b",fontSize:e?"12px":"14px"},children:"Loading users..."})}):c.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:6,style:{padding:e?"12px":"20px",textAlign:"center",color:"#94a3b8",fontSize:e?"12px":"14px"},children:"No users found."})}):c.map(t=>r.jsxs("tr",{style:{borderTop:"1px solid rgba(148, 163, 184, 0.2)",background:"rgba(255, 255, 255, 0.7)"},children:[r.jsx("td",{style:{padding:e?"10px 8px":"14px 16px",fontSize:e?"11px":"14px",color:"#0f172a",fontWeight:"600",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:t.name}),r.jsx("td",{style:{padding:e?"10px 8px":"14px 16px",fontSize:e?"11px":"14px",color:"#1e293b",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:t.username}),r.jsx("td",{style:{padding:e?"10px 8px":"14px 16px",fontSize:e?"11px":"14px",color:"#1e293b",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:t.email}),r.jsx("td",{style:{padding:e?"10px 8px":"14px 16px",whiteSpace:"nowrap"},children:r.jsx("span",{style:{display:"inline-flex",alignItems:"center",gap:"4px",padding:e?"4px 8px":"6px 12px",borderRadius:"999px",background:t.role==="admin"?"linear-gradient(135deg, rgba(59, 130, 246, 0.18), rgba(37, 99, 235, 0.18))":"linear-gradient(135deg, rgba(34, 197, 94, 0.18), rgba(22, 163, 74, 0.18))",color:t.role==="admin"?"#1d4ed8":"#166534",fontSize:e?"10px":"12px",fontWeight:"600",border:t.role==="admin"?"1px solid rgba(37, 99, 235, 0.24)":"1px solid rgba(22, 163, 74, 0.24)",whiteSpace:"nowrap"},children:t.role==="admin"?"Admin":"User"})}),r.jsx("td",{style:{padding:e?"10px 8px":"14px 16px",fontSize:e?"10px":"13px",color:"#475569",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:C(t.createdAt)}),r.jsx("td",{style:{padding:e?"10px 8px":"14px 16px",fontFamily:"monospace",fontSize:e?"10px":"13px",color:"#64748b",whiteSpace:"nowrap"},children:A(t.id)})]},t.id||t.email))})]})})]})]})]})})}export{P as default};
